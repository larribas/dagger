apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: passing-parameters-
spec:
  entrypoint: main
  templates:
  - name: main
    dag:
      tasks:
      - name: generate-random-number
        template: generate-random-number
      - name: echo-number
        template: echo-number
        dependencies: [generate-random-number]
        arguments:
          parameters:
          - name: number
            value: "{{tasks.generate-random-number.outputs.parameters.number}}"

  - name: generate-random-number
    container:
      image: 524837408336.dkr.ecr.eu-west-1.amazonaws.com/workflow-poc:latest
      command: [passing-parameters]
      args:
      - --node-name=generate-random-number
      volumeMounts:
      - name: tmp
        mountPath: /tmp
    outputs:
      parameters:
      - name: number
        valueFrom:
          path: /tmp/generate-random-number.number.txt
    volumes:
      - name: tmp
        emptyDir: {}

  - name: echo-number
    inputs:
      parameters:
      - name: number
    container:
      image: 524837408336.dkr.ecr.eu-west-1.amazonaws.com/workflow-poc:latest
      command: [passing-parameters]
      args:
      - --node-name=echo-number
      - --param-number="{{ inputs.parameters.number }}"
